services:
  signal-service:
    image: docker.io/ahmedatoasis/wt3-signal@sha256:fb91d981068fa1c6166a0bed0e7519d7d3c69e2b366ab8e32b48f49beadc2ba1
    build:
      context: .
      dockerfile: Dockerfile.signal
    platform: linux/amd64
    volumes:
      - /run/rofl-appd.sock:/run/rofl-appd.sock
      - /storage:/storage
    environment:
      - AGE_PRIVATE_KEY=${AGE_PRIVATE_KEY}
    restart: always
    ports:
      - "8000:8000"

  wt3:
    image: docker.io/ahmedatoasis/wt3@sha256:6065cb49ead20fb4af15ce85aedc69a1ecc0d27026407192e337e6fca66f2c34
    build:
      context: .
      dockerfile: Dockerfile
    platform: linux/amd64
    volumes:
      - /run/rofl-appd.sock:/run/rofl-appd.sock
      - /storage:/storage
    environment:
      - GROK_API_KEY=${GROK_API_KEY}
      - TWITTER_BEARER_TOKEN=${TWITTER_BEARER_TOKEN}
      - TWITTER_API_KEY=${TWITTER_API_KEY}
      - TWITTER_API_SECRET=${TWITTER_API_SECRET}
      - TWITTER_ACCESS_TOKEN=${TWITTER_ACCESS_TOKEN}
      - TWITTER_ACCESS_TOKEN_SECRET=${TWITTER_ACCESS_TOKEN_SECRET}
      - SIGNAL_SERVICE_URL=${SIGNAL_SERVICE_URL}
    depends_on:
      - signal-service
    restart: always
